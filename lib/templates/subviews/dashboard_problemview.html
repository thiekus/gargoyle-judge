<div class="row">
    <div class="col-12 col-md-9">
        <div class="card">
            <!--<div class="card-header">
                <h4 class="card-title text-center">{{.PageData.Name}}
                </h4>
            </div>-->
            <div class="card-content collapse show">
                <div class="card-body">
                    <div class="card box-shadow-0 border-primary">
                        <div class="card-header card-head-inverse bg-primary">
                            <h4 class="card-title text-white float-left">
                                <i class="fas fa-puzzle-piece mr-1"></i>
                                {{.PageData.Name}}
                            </h4>
                            <div class="heading-elements float-right">
                                <!-- Caption kanan -->
                                <span id="tiktokContainer" style="display: none"
                                    ><i class="fas fa-stopwatch mr-1"></i
                                    ><span id="tiktok"></span
                                ></span>
                            </div>
                        </div>
                        <div class="card-content collapse show">
                            <div class="card-body">
                                <div class="d-flex justify-content-center">
                                    <table>
                                        <tr>
                                            <td>
                                                <i
                                                    class="fas fa-stopwatch mr-1"
                                                ></i>
                                            </td>
                                            <td>Time limit</td>
                                            <td>
                                                : {{.PageData.TimeLimit}} detik
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <i
                                                    class="fas fa-memory mr-1"
                                                ></i>
                                            </td>
                                            <td>Memory limit</td>
                                            <td>: {{.PageData.MemLimit}} MB</td>
                                        </tr>
                                    </table>
                                </div>

                                <p>{{.PageData.Description}}</p>
                                <br />

                                <div class="card box-shadow-0 border-info">
                                    <div
                                        class="card-header card-head-inverse bg-primary"
                                    >
                                        <h4 class="card-title text-white">
                                            <i
                                                class="fas fa-file-upload mr-1"
                                            ></i>
                                            Submit Solution
                                        </h4>
                                        <a class="heading-elements-toggle"
                                            ><i
                                                class="la la-ellipsis-v font-medium-3"
                                            ></i
                                        ></a>
                                        <div class="heading-elements">
                                            <!-- Caption kanan -->
                                        </div>
                                    </div>
                                    <div class="card-content collapse show">
                                        <div class="card-body">
                                            <div class="tab-outline">
                                                <ul
                                                    class="nav nav-tabs"
                                                    id="myTab2"
                                                    role="tablist"
                                                >
                                                    <li class="nav-item">
                                                        <a
                                                            class="nav-link active"
                                                            id="tab-outline-one"
                                                            data-toggle="tab"
                                                            href="#outline-one"
                                                            role="tab"
                                                            aria-controls="home"
                                                            aria-selected="true"
                                                            ><i
                                                                class="fas fa-file-import mr-1"
                                                            ></i>
                                                            Upload Code File</a
                                                        >
                                                    </li>
                                                    <li class="nav-item">
                                                        <a
                                                            class="nav-link"
                                                            id="tab-outline-two"
                                                            data-toggle="tab"
                                                            href="#outline-two"
                                                            role="tab"
                                                            aria-controls="profile"
                                                            aria-selected="false"
                                                            ><i
                                                                class="fas fa-code mr-1"
                                                            ></i>
                                                            Paste Code</a
                                                        >
                                                    </li>
                                                </ul>
                                                <div
                                                    class="tab-content"
                                                    id="myTabContent2"
                                                >
                                                    <div
                                                        class="tab-pane fade show active"
                                                        id="outline-one"
                                                        role="tabpanel"
                                                        aria-labelledby="tab-outline-one"
                                                    >
                                                        <!-- Form submissions by upload -->
                                                        <form
                                                            method="POST"
                                                            action="{{.BaseUrl}}dashboard/problem"
                                                            enctype="multipart/form-data"
                                                            gyExcludeQuickForm="yes"
                                                        >
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <input
                                                                    type="hidden"
                                                                    name="inputType"
                                                                    value="file"
                                                                />
                                                                <input
                                                                    type="hidden"
                                                                    name="problemId"
                                                                    value="{{.PageData.Id}}"
                                                                />
                                                                <input
                                                                    type="hidden"
                                                                    name="problemSetId"
                                                                    value="{{.PageData.ContestId}}"
                                                                />
                                                                <label
                                                                    for="langSelectFile"
                                                                    >Bahasa
                                                                    Pemrograman:</label
                                                                >
                                                                <select
                                                                    id="langSelectFile"
                                                                    class="form-control"
                                                                    name="lang"
                                                                >
                                                                    {{with .PageData.AllowedLang}}
                                                                    {{range .}}
                                                                    <option
                                                                        value="{{.Id}}"
                                                                    >
                                                                        {{.DisplayName}}
                                                                    </option>
                                                                    {{end}}
                                                                    {{end}}
                                                                </select>
                                                                <br />
                                                                <label
                                                                    for="langFile"
                                                                    >Source Code
                                                                    Program:</label
                                                                >
                                                                <div
                                                                    id="langFile"
                                                                    class="custom-file"
                                                                >
                                                                    <input
                                                                        type="file"
                                                                        class="custom-file-input"
                                                                        id="inputSrc"
                                                                        name="sourceCodeFile"
                                                                    />
                                                                    <label
                                                                        class="custom-file-label"
                                                                        for="inputSrc"
                                                                        >Choose
                                                                        file</label
                                                                    >
                                                                </div>
                                                                <br /><br />
                                                                <div
                                                                    class="text-right"
                                                                >
                                                                    <button
                                                                        type="submit"
                                                                        class="btn btn-success"
                                                                    >
                                                                        <i
                                                                            class="fas fa-check-circle"
                                                                        ></i>
                                                                        Submit
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                    <div
                                                        class="tab-pane fade"
                                                        id="outline-two"
                                                        role="tabpanel"
                                                        aria-labelledby="tab-outline-two"
                                                    >
                                                        <!-- Form submissions by code -->
                                                        <form
                                                            method="POST"
                                                            action="{{.BaseUrl}}dashboard/problem"
                                                            enctype="multipart/form-data"
                                                        >
                                                            <div
                                                                class="form-group"
                                                            >
                                                                <input
                                                                    type="hidden"
                                                                    name="inputType"
                                                                    value="text"
                                                                />
                                                                <input
                                                                    type="hidden"
                                                                    name="problemId"
                                                                    value="{{.PageData.Id}}"
                                                                />
                                                                <input
                                                                    type="hidden"
                                                                    name="problemSetId"
                                                                    value="{{.PageData.ContestId}}"
                                                                />
                                                                <label
                                                                    for="langSelectCode"
                                                                    >Programming Language:</label
                                                                >
                                                                <select
                                                                    id="langSelectCode"
                                                                    class="form-control"
                                                                    name="lang"
                                                                >
                                                                    {{with .PageData.AllowedLang}}
                                                                    {{range .}}
                                                                    <option
                                                                        value="{{.Id}}"
                                                                        syntaxName="{{.SyntaxName}}"
                                                                    >
                                                                        {{.DisplayName}}
                                                                    </option>
                                                                    {{end}}
                                                                    {{end}}
                                                                </select>
                                                                <br />
                                                                <label
                                                                    for="sourceCodeEditor"
                                                                    >Source Code
                                                                    Program:</label
                                                                >
                                                                <textarea
                                                                    name="sourceCodeText"
                                                                ></textarea>
                                                                <div
                                                                    id="sourceCodeEditor"
                                                                    class="codeblock"
                                                                    style="
                                                                        min-height: 300px;
                                                                    "
                                                                ></div>
                                                                <br />
                                                                <div
                                                                    class="text-right"
                                                                >
                                                                    <button
                                                                        type="submit"
                                                                        class="btn btn-success"
                                                                    >
                                                                        <i
                                                                            class="fas fa-check-circle"
                                                                        ></i>
                                                                        Submit
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-12 col-md-3">
        <!-- Navigation -->
        <div class="card">
            <div class="card-header">
                <h4 class="card-title text-center">Navigation</h4>
            </div>
            <div class="card-body">
                <!-- Navs button groups -->
                <div class="btn-group-vertical" style="width: 100%">
                    <a
                        class="btn btn-outline-dark text-left"
                        href="{{.BaseUrl}}{{.PageData.ContestUrl}}"
                        ><i class="fas fa-arrow-circle-left mr-2"></i> Back to
                        Details</a
                    >
                    <a
                        class="btn btn-outline-dark text-left"
                        href="{{.BaseUrl}}dashboard/userSubmissions?problem={{.PageData.Id}}"
                        ><i class="far fa-eye mr-2"></i> Submission History</a
                    >
                    <a
                        class="btn btn-outline-dark text-left"
                        href="{{.BaseUrl}}dashboard/scoreboard/{{.PageData.ContestId}}"
                        ><i class="fas fa-chalkboard mr-2"></i> Scoreboard</a
                    >
                </div>
            </div>
        </div>

        <!-- Problemlist -->
        <div class="card">
            <div class="card-header">
                <h4 class="card-title text-center">Problem Set</h4>
            </div>
            <div class="card-body">
                {{if gt .PageData.ProblemCount 0}}
                <!-- Problem button groups -->
                <div class="btn-group-vertical" style="width: 100%">
                    {{$thisProblemId := .PageData.Id}}
                    {{$baseUrl := .BaseUrl}}
                    {{with .PageData.Problems}}
                    {{range .}}
                    {{$active := ""}}
                    {{if eq .Id $thisProblemId}}
                    {{$active = "active"}}
                    {{end}}
                    <a
                        href="{{$baseUrl}}{{.ProblemUrl}}"
                        class="btn btn-outline-primary text-left {{$active}}"
                        ><i class="fas fa-puzzle-piece mr-2"></i> {{.Name}}</a
                    >
                    {{end}}
                    {{end}}
                </div>
                {{else}}
                <p>No problem found!</p>
                {{end}}
            </div>
        </div>
    </div>
</div>

<!-- Ace Code Highlighting -->
<script
    src="{{.BaseUrl}}assets/shared/ace/src-min-noconflict/ace.js"
    type="text/javascript"
    charset="utf-8"
></script>

<script id="gySubviewScript">
    var scEditor, scTextarea;

    function initializeEditor() {
        // Set source code editor
        scEditor = ace.edit("sourceCodeEditor");
        scEditor.setOptions({
            maxLines: Infinity,
        });
        scEditor.setTheme("ace/theme/{{.UserData.SyntaxTheme}}");
        var syntaxName = $("#langSelectCode")
            .children("option:selected")
            .attr("syntaxName");
        scEditor.session.setMode("ace/mode/" + syntaxName);
        // Initialize reference to real textarea
        scTextarea = $('textarea[name="sourceCodeText"]');
        scTextarea.hide();
        scTextarea.closest("form").submit(function () {
            scTextarea.val(scEditor.getSession().getValue());
        });
    }

    function subviewInit() {
        var remainTime = parseInt("{{.PageData.RemainingTime}}");
        if (remainTime >= 0) {
            $("#tiktokContainer").show();
            setTickTock(remainTime);
        }
        $("#langSelectCode").change(function () {
            var syntaxName = $(this)
                .children("option:selected")
                .attr("syntaxName");
            //console.log(syntaxName);
            scEditor.session.setMode("ace/mode/" + syntaxName);
        });
        initializeEditor();
    }
</script>
